name: nativefier
adopt-info: nativefier
summary: Nativefier is a command-line tool to easily create a “desktop app”
description: |
  Nativefier is a command-line tool to easily create a “desktop app” for any web site with minimal fuss. 
  Apps are wrapped by Electron (which uses Chromium under the hood) in an OS executable (.app, .exe, etc) usable on Windows, macOS and Linux.
  
license: MIT

base: core20
grade: stable
confinement: strict

assumes:
  - command-chain

apps:
  nativefier: 
    command: nativefier
    command-chain: 
      - bin/homeishome-launch
    plugs:
      - network
      - home  
  
parts: 
  nativefier:
    plugin: nil
    source: https://github.com/nativefier/nativefier.git
    source-type: git
    override-build: |
      npm install nativefier -g --unsafe-perm=true --desructive-mode=true
      cp -rv /root/nativefier/parts/nativefier* $SNAPCRAFT_PART_INSTALL/nativefier

    build-packages:
      - git
      - npm
    
    stage-packages:
      - npm

    override-pull: |
      snapcraftctl pull
      snapcraftctl set-version "$(git describe --tags | sed 's/^v//' | cut -d "-" -f1)"
